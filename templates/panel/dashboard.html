{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container" style="padding-top:32px;padding-bottom:48px;">

  <!-- Welcome Header -->
  <div class="row" style="margin-bottom:24px;">
    <div class="col s12">
      <div style="background:#003087;border-radius:10px;padding:28px 32px;color:#fff;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
        <div>
          <h5 style="margin:0;font-weight:700;">
            <i class="material-icons" style="vertical-align:middle;margin-right:8px;">how_to_vote</i>
            Panel Member Dashboard
          </h5>
          <p style="margin:6px 0 0;opacity:0.85;font-size:14px;">
            Welcome, {{ request.user.get_full_name|default:request.user.username }}.
            You have {{ interviews|length }} assigned interview{{ interviews|length|pluralize }}.
          </p>
        </div>
        <div style="text-align:right;">
          <div style="font-size:2rem;font-weight:800;">{{ interviews|length }}</div>
          <div style="font-size:12px;opacity:0.8;">Assigned Interviews</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Assigned Interviews Card -->
  <div class="row">
    <div class="col s12">
      <div class="card" style="border-radius:8px;">
        <div class="card-content" style="padding-bottom:0;">
          <span class="card-title" style="color:#003087;font-weight:700;font-size:18px;">
            <i class="material-icons tiny">event_note</i> Assigned Interviews
          </span>
        </div>

        {% if interviews %}
          <div class="responsive-table">
            <table class="striped hoverable" style="font-size:13px;">
              <thead style="background:#003087;">
                <tr>
                  <th style="color:#fff;">Applicant</th>
                  <th style="color:#fff;">Position</th>
                  <th style="color:#fff;">Date &amp; Time</th>
                  <th style="color:#fff;">Venue</th>
                  <th style="color:#fff;text-align:center;">Status</th>
                  <th style="color:#fff;text-align:center;">Scored</th>
                  <th style="color:#fff;text-align:center;">Action</th>
                </tr>
              </thead>
              <tbody>
                {% for interview in interviews %}
                  <tr>
                    <td>
                      <div style="font-weight:700;color:#222;">{{ interview.application.full_name }}</div>
                      <div style="font-size:11px;color:#888;">{{ interview.application.province }}</div>
                    </td>
                    <td style="max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"
                        title="{{ interview.application.vacancy.title }}">
                      {{ interview.application.vacancy.title }}
                    </td>
                    <td style="white-space:nowrap;">
                      <div style="font-weight:600;color:#003087;">{{ interview.scheduled_at|date:"d M Y" }}</div>
                      <div style="font-size:12px;color:#666;">{{ interview.scheduled_at|time:"H:i" }}</div>
                    </td>
                    <td style="max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"
                        title="{{ interview.venue }}">
                      {{ interview.venue|default:"TBA" }}
                    </td>
                    <td style="text-align:center;">
                      {% now "Y-m-d H:i" as now_str %}
                      {% if interview.scheduled_at|date:"Y-m-d H:i" < now_str %}
                        <span class="chip" style="background:#e8f5e9;color:#2e7d32;font-size:11px;">Completed</span>
                      {% else %}
                        <span class="chip" style="background:#e3eaf6;color:#003087;font-size:11px;">Upcoming</span>
                      {% endif %}
                    </td>
                    <td style="text-align:center;">
                      {% if interview.has_my_score %}
                        <span class="chip" style="background:#e8f5e9;color:#2e7d32;font-size:11px;">
                          <i class="material-icons tiny">check</i> Scored
                        </span>
                      {% else %}
                        <span class="chip" style="background:#ffebee;color:#c62828;font-size:11px;">
                          <i class="material-icons tiny">pending</i> Pending
                        </span>
                      {% endif %}
                    </td>
                    <td style="text-align:center;">
                      <a href="{% url 'panel:application_view' interview.pk %}"
                         class="btn-small" style="background:#003087;white-space:nowrap;">
                        {% if interview.has_my_score %}
                          <i class="material-icons left" style="font-size:14px;">visibility</i>View
                        {% else %}
                          <i class="material-icons left" style="font-size:14px;">rate_review</i>Score
                        {% endif %}
                      </a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="empty-state" style="padding:80px 40px;text-align:center;color:#aaa;">
            <i class="material-icons" style="font-size:72px;color:#e0e0e0;">event_busy</i>
            <h6 style="color:#bbb;margin:16px 0 8px;">No interviews assigned</h6>
            <p style="font-size:14px;color:#ccc;max-width:400px;margin:0 auto;">
              You have no interviews assigned at the moment. Interviews assigned by HR will appear here.
            </p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Info Note -->
  {% if interviews %}
    <div class="row">
      <div class="col s12">
        <div style="background:#e3eaf6;border-left:4px solid #003087;border-radius:6px;padding:12px 16px;font-size:13px;color:#003087;">
          <i class="material-icons tiny">info</i>
          <strong>Note:</strong> Please submit your scores before the interview deadline.
          Contact HR Administration if you have any questions about your assigned interviews.
        </div>
      </div>
    </div>
  {% endif %}

</div>
{% endblock %}
